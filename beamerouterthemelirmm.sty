% Author: Fabien.Soulier@lirmm.fr
% Graphic Chart: Virginie.Feche@lirmm.fr

\ProvidesPackage{beamerouterthemelirmm}[2017/09/01 Beamer outer theme for the LIRMM, v1.0]
\mode<presentation>

% Define background drawings.

\setbeamertemplate{background}{
  \begin{tikzpicture}[x=1cm, y=1cm]
  \useasboundingbox (0,0) rectangle(\the\paperwidth,\the\paperheight);
  \ifnum \value{page}=1 % Titleframe
    \node[draw, hexagon = 2.57cm, lirmm@blue, thick] at(0, 7.04){};
    \node[draw, hexagon = 2.57cm, black, thick] at(0, 2.30){};
    \node[draw, hexagon = 2.57cm, red, thick] at(1.29, 4.68){};
    \node[draw, hexagon = 2.57cm, lirmm@blue, thick] at(3.87, 4.59){};
    \node[draw, hexagon = 2.57cm, orange, thick] at(2.7, 7.04){};
    \node[draw, hexagon = 1.27cm, red] at(1.37, 8.47){};
    \node[draw, hexagon = 1.31cm, orange] at(2.46, 3.04){};
    \node[inner sep=0pt] at (10.85, 8.25) {\includegraphics[width=1.67cm]{theme/lirmmlogo}};
    \node[inner sep=0pt] at (11.66, 1.31) {\includegraphics[height=.9cm]{theme/umlogo}};
    \node[inner sep=0pt] at (10.42, 1.34) {\includegraphics[height=.84cm]{theme/cnrslogo}};
  \else % Other frames
    \node[draw, hexagon = .79cm, black] at(.36, 9.20){};
    \node[draw, hexagon = .79cm, red] at(1.16, 9.10){};
    \node[draw, hexagon = .79cm, orange] at(.71, 8.46){};
    \node[draw, hexagon = .79cm, lirmm@blue] at(1.51, 8.39){};
    \fill[lirmm@blue] (1.86, 8.34) rectangle (6.94, 8.44);
    \fill[orange] (6.94, 8.34) rectangle (9.44, 8.44);
    \fill[red] (9.44, 8.34) rectangle (11.94, 8.44);
  \fi
  \end{tikzpicture}
}

% Frame title positionning.
% Slightly modified from Beamer default
%   1.5cm on left
%   0.4cm before subtitle

\defbeamertemplate*{frametitle}{lirmm}[1][left]{
  \ifbeamercolorempty[bg]{frametitle}{}{\nointerlineskip}%
  \@tempdima=\textwidth%
  \advance\@tempdima by\beamer@leftmargin%
  \advance\@tempdima by\beamer@rightmargin%
  \begin{beamercolorbox}[sep=0.3cm,#1,wd=\the\@tempdima, leftskip=1.5cm]{frametitle}
    \usebeamerfont{frametitle}%
    \vbox{}\vskip-1ex%
    \if@tempswa\else\csname beamer@fte#1\endcsname\fi%
    \strut\insertframetitle\strut\par%
    {%
      \ifx\insertframesubtitle\@empty%
      \else%
      {\vskip.4cm\hfill\usebeamerfont{framesubtitle}\usebeamercolor[fg]{framesubtitle}\insertframesubtitle\strut\par}%
      \fi
    }%
    \vskip-1ex%
    \if@tempswa\else\vskip-.3cm\fi% set inside beamercolorbox... evil here...
  \end{beamercolorbox}%
}

% Here we add page number and skip the logo.

\defbeamertemplate*{sidebar right}{lirmm}{%
  \vfill%
  \llap{%
    \usebeamertemplate***{navigation symbols}%
    \hskip.4cm
    \raisebox{.2cm}{\color{lirmm@blue}\tiny\bf\thepage}\hskip0.4cm}%
  \vskip2pt}

\mode<all>
